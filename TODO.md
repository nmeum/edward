# POSIX Compatibility

* align handling of end-of-file character with POSIX
	* Scheme's read-char procedure does not allow
	  reading past EOF but ed requires this
	* Problem: Reading a full UTF8 character, not a
	  byte with a POSIX API from CHICKEN is annoying
	* Using fgetsws(3) might be possible but requires
	  depending on SRFI 4 for u32vector to wrap wchar_t*
	* Implementing this might get easier with
	  https://wiki.call-cc.org/unicode-transition if the
	  transition adds an incremental UTF-8 decoder to CHICKEN
* consider treating undo with empty undo stack as an error

# Support for custom commands

* Move lib/ed/cmd.scm and lib/ed/editor.scm to separate libraries
* Define a clean interface for lib/ed/editor.scm
* Add additional sanity checks to register-command
	* Don't allow defining same command name twice
	* Don't allow defining same command character twice (difficult)
* Load ~/.edwardrc in bin/edward.scm
* Provide documentation and examples for custom commands
* Consider adjusting edward ed macros to not modify the environment

# Miscellaneous

* Consider using Declarations and (chicken type) to enable more optimizations
	* https://wiki.call-cc.org/programming-for-performance
	* https://wiki.call-cc.org/man/5/Declarations
	* https://wiki.call-cc.org/man/5/Foreign%20type%20specifiers
* Figure out why edward is slower when compiled statically with eggs (linkage static)
* Integration tests: compare exit status
* Use posix-regex multiline feature instead of matching lines individually
* Make more use of parse-lazy and parse-memoize (see (chibi parse) documentation)
* Use chicken locative instead of editor-get-lnum hack to deal with pointers to lines
	* This requires the locative-index procedure (not available in CHiCKEN 5.3)
	* See ef2d98332b4d453288dc98298c394d8af645c863 in chicken-core.git
* Profile larger ed inputs (e.g. as generated by a fuzzer) with
  chicken-profile and figure identify (parsing) procedures which
  could be further optimized for performance
* Improve parser error messages (mostly returns `failed char pred` currently)
